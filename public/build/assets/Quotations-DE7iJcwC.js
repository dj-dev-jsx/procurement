import{r,m as v,j as e,$ as b}from"./app-93n4-YE1.js";import{A as w}from"./ApproverLayout-CJpNhpE3.js";import{T as P}from"./Tooltip-BDMbMjY5.js";import"./Dropdown--SqrWfdR.js";import"./transition-B8_0YiEE.js";import"./toaster-CR_CLjT4.js";import"./index-BYPC565r.js";import"./index-DEGu_kMU.js";import"./index-C6Troi14.js";import"./XMarkIcon-BajPl_Ya.js";import"./ClipboardDocumentIcon-rUgeVu8g.js";import"./clipboard-check-BUpBKaMS.js";import"./circle-check-big-CDYAS76j.js";import"./file-text-BWCkVFPU.js";import"./BellAlertIcon-DQ7YZFl9.js";function k({purchaseRequests:i,filters:l={}}){const[o,p]=r.useState(l.prNumber||""),[n,h]=r.useState(l.focalPerson||""),[c,g]=r.useState(l.division||"");return console.log(i),r.useEffect(()=>{const t=setTimeout(()=>{v.get(route("bac_approver.for_quotations"),{prNumber:o,focalPerson:n,division:c},{preserveState:!0,preserveScroll:!0,replace:!0})},400);return()=>clearTimeout(t)},[o,n,c]),e.jsxs(w,{header:"Schools Divisions Office - Ilagan | Purchase Requests",children:[e.jsx(b,{title:"Approved Purchase Requests"}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Purchase Requests for Quotation"})}),e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:t=>p(t.target.value),placeholder:"Search PR Number...",className:"rounded-md border border-gray-300 px-4 py-2 text-sm shadow-sm w-60"}),e.jsx("input",{type:"text",value:n,onChange:t=>h(t.target.value),placeholder:"Search Focal Person...",className:"rounded-md border border-gray-300 px-4 py-2 text-sm shadow-sm w-60"}),e.jsxs("select",{value:c,onChange:t=>g(t.target.value),className:"rounded-md border border-gray-300 px-4 py-2 text-sm shadow-sm w-44",children:[e.jsx("option",{value:"",children:"All Divisions"}),e.jsx("option",{value:"1",children:"SGOD"}),e.jsx("option",{value:"2",children:"OSDS"}),e.jsx("option",{value:"3",children:"CID"})]})]})}),i.length===0?e.jsx("p",{className:"text-center text-gray-500 py-12 text-lg font-medium",children:"No Purchase Request found"}):e.jsx("div",{className:"overflow-x-auto rounded-md border border-gray-200 shadow-sm bg-white",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsx("tr",{children:["PR Number","Focal Person","Division","Item","Specs","Unit","Quantity","Total Price","Actions"].map(t=>e.jsx("th",{className:"px-4 py-3 text-xs font-semibold uppercase tracking-wider text-center",children:t},t))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:i.map(t=>{var u;const d=t.details.map(s=>s.item),m=t.details.map(s=>s.unit);t.details.map(s=>s.specs);const x=t.details.map(s=>s.quantity),y=t.details.reduce((s,a)=>s+a.unit_price*a.quantity,0),f=d.slice(0,2).join(", "),j=d.length>2?` +${d.length-2} more`:"";return e.jsxs("tr",{className:"hover:bg-blue-50 text-center",children:[e.jsx("td",{className:"px-4 py-2 font-semibold",children:t.rfqs&&t.rfqs.length>0?e.jsx(P,{to:route("bac_approver.abstract_of_quotations",t.id),tooltip:"View Abstract of Quotations",className:"text-indigo-600 hover:underline",children:t.pr_number}):e.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[e.jsx("span",{className:"cursor-not-allowed",children:t.pr_number}),e.jsx("small",{className:"text-xs italic text-red-500",children:"No quotations yet"})]})}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:[t.focal_person.firstname,t.focal_person.middlename,t.focal_person.lastname].filter(Boolean).join(" ")}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:t.division.division}),e.jsxs("td",{className:"px-4 py-2 text-gray-700",children:[f,j]}),e.jsx("td",{className:"px-4 py-2 text-gray-700 text-left",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[t.details.slice(0,2).map((s,a)=>e.jsx("li",{children:s.specs},a)),t.details.length>2&&e.jsxs("li",{className:"text-gray-500 italic",children:["+",t.details.length-2," more"]})]})}),e.jsxs("td",{className:"px-4 py-2 text-gray-700",children:[m.slice(0,2).join(", "),m.length>2?` +${m.length-2} more`:""]}),e.jsxs("td",{className:"px-4 py-2 text-gray-700",children:[x.slice(0,2).join(", "),x.length>2?` +${x.length-2} more`:""]}),e.jsxs("td",{className:"px-4 py-2 text-gray-700",children:["₱",y.toLocaleString()]}),e.jsx("td",{className:"px-4 py-2",children:(u=t.rfqs)!=null&&u.some(s=>{var a;return(a=s.details)==null?void 0:a.some(N=>N.is_winner)})?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("button",{disabled:!0,className:"inline-flex items-center px-4 py-2 bg-gray-400 text-white text-sm font-medium rounded-md cursor-not-allowed",title:"Winner already selected, cannot enter quoted price",children:[e.jsx("span",{className:"mr-2",children:"₱"})," Enter Quoted Price"]}),e.jsx("small",{className:"text-xs text-red-500 mt-1 text-center",children:"A winner has already been selected for this PR"})]}):e.jsxs("a",{href:route("bac_approver.quoted_price",t.id),className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 transition focus:outline-none focus:ring-2 focus:ring-green-400",children:[e.jsx("span",{className:"mr-2",children:"₱"})," Enter Quoted Price"]})})]},t.id)})})]})})]})]})}export{k as default};
